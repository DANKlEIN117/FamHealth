const e=null,{min:t,max:o,abs:r,floor:s}=Math,n=(e,r,s)=>t(s,o(r,e)),c=e=>[...e].sort(((e,t)=>e-t)),i="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},l=()=>{let e;return[new Promise((t=>{e=t})),e]},f=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},a=(e,t,o)=>{const r=o?"unshift":"push";for(let o=0;o<t;o++)e[r](-1);return e},u=(e,t)=>{const o=e.t[t];return-1===o?e.o:o},$=(e,o,r)=>{const s=-1===e.t[o];return e.t[o]=r,e.i=t(o,e.i),s},d=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let o=e.i,r=e.u[o];for(;o<t;)r+=u(e,o),e.u[++o]=r;return e.i=t,r},h=(e,t,o=0,r=e.l-1)=>{for(;o<=r;){const n=s((o+r)/2);if(d(e,n)<=t){if(d(e,n+1)>t)return n;o=n+1}else r=n-1}return n(o,0,e.l-1)},p=(e,o,r)=>{const s=o-e.l;return e.i=r?-1:t(o-1,e.i),e.l=o,s>0?(a(e.u,s),a(e.t,s,r),e.o*s):(e.u.splice(s),(r?e.t.splice(0,-s):e.t.splice(s)).reduce(((t,o)=>t-(-1===o?e.o:o)),0))},b="undefined"!=typeof window,g=()=>document.documentElement,m=e=>e.ownerDocument,v=e=>e.defaultView,w=/*#__PURE__*/f((()=>!!b&&"rtl"===getComputedStyle(g()).direction)),S=/*#__PURE__*/f((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>0)),k=/*#__PURE__*/f((()=>"scrollBehavior"in g().style)),I=5,x=6,y=1,_=4,z=8,T=e=>o(e.$getTotalSize(),e.$getViewportSize()),M=(s,n=40,i=0,l,f=!1)=>{let b=!!i,g=1,m=0,v=0,w=0,k=0,I=0,x=0,y=0,_=0,z=e,T=[0,b?o(i-1,0):-1],M=0;const R=((e,r,s)=>({o:s?s[1]:r,t:s&&s[0]?a(s[0].slice(0,t(e,s[0].length)),o(0,e-s[0].length)):a([],e),l:e,i:-1,u:a([],e+1)}))(s,n,l),J=new Set,W=()=>w-v,B=()=>W()+I+k,C=(e,o)=>((e,o,r,s)=>{if(s=t(s,e.l-1),d(e,s)<=o){const t=h(e,r,s);return[h(e,o,s,t),t]}{const t=h(e,o,void 0,s);return[t,h(e,r,t)]}})(R,e,o,T[0]),L=()=>d(R,R.l),O=e=>d(R,e)-I,P=e=>u(R,e),q=(e,t=-1)=>R.t[e]===t,V=e=>{e&&(S()&&0!==y||z&&1===_?I+=e:k+=e)};return{$dispose:()=>{J.clear()},$getStateVersion:()=>g,$getCacheSnapshot:()=>(e=>[e.t.slice(),e.o])(R),$getRange:(e=200)=>{if(!m||b)return T;let r,s;if(x)[r,s]=T;else{let n=o(0,B()),c=n+m;f||(e=o(0,e),1!==y&&(n-=e),2!==y&&(c+=e)),[r,s]=T=C(o(0,n),o(0,c)),z&&(r=t(r,z[0]),s=o(s,z[1]))}return[o(r,0),t(s,R.l-1)]},$findStartIndex:()=>h(R,B()),$findEndIndex:()=>h(R,B()+m),$isUnmeasuredItem:q,$getItemOffset:O,$getItemSize:P,$getItemsLength:()=>R.l,$getScrollOffset:()=>w,$isScrolling:()=>0!==y,$getViewportSize:()=>m,$getStartSpacerSize:()=>v,$getTotalSize:L,$:()=>(x=k,k=0,[x,2===_]),$subscribe:(e,t)=>{const o=[e,t];return J.add(o),()=>{J.delete(o)}},$update:(t,s)=>{let n,i,l=0;switch(t){case 1:{if(s===w&&0===_)break;const e=x;x=0;const t=s-w,o=r(t);e&&o<r(e)+1||0!==_||(y=t<0?2:1),b&&(b=!1),w=s,l=4;const n=W();n>=-m&&n<=L()&&(l+=1,i=o>m);break}case 2:l=8,0!==y&&(n=!0,l+=1),y=0,_=0,z=e;break;case 3:{const e=s.filter((([e,t])=>!q(e,t)));if(!e.length)break;V(e.reduce(((e,[t,o])=>((2===_||(z&&1===_?t<z[0]:O(t+(0===y&&0===_?1:0))<W()))&&(e+=o-P(t)),e)),0));for(const[t,o]of e){const e=P(t),r=$(R,t,o);f&&(M+=r?o:o-e)}f&&m&&M>m&&(V(((e,t)=>{let r=0;const s=[];e.t.forEach(((e,o)=>{-1!==e&&(s.push(e),o<t&&r++)})),e.i=-1;const n=c(s),i=n.length,l=i/2|0,f=i%2==0?(n[l-1]+n[l])/2:n[l],a=e.o;return((e.o=f)-a)*o(t-r,0)})(R,h(R,B()))),f=!1),l=3,i=!0;break}case 4:m!==s&&(m||(i=!0),m=s,l=3);break;case 5:s[1]?(V(p(R,s[0],!0)),_=2,l=1):(p(R,s[0]),l=1);break;case 6:v=s;break;case 7:_=1;break;case 8:z=C(s,s+m),l=1}l&&(g=1+(2147483647&g),n&&I&&(k+=I,I=0),J.forEach((([e,t])=>{l&e&&t(i)})))}}},R=setTimeout,J=(e,t)=>t&&w()?-e:e,W=(t,o,r,s,n,c)=>{const i=Date.now;let l=0,f=!1,a=!1,u=!1,$=!1;const d=(()=>{let o;const r=()=>{o!=e&&clearTimeout(o)},s=()=>{r(),o=R((()=>{o=e,(()=>{if(f||a)return f=!1,void d();u=!1,t.$update(2)})()}),150)};return s.h=r,s})(),h=()=>{l=i(),u&&($=!0),c&&t.$update(6,c()),t.$update(1,s()),d()},p=e=>{if(f||!t.$isScrolling()||e.ctrlKey)return;const o=i()-l;150>o&&50<o&&(r?e.deltaX:e.deltaY)&&(f=!0)},b=()=>{a=!0,u=$=!1},g=()=>{a=!1,S()&&(u=!0)};return o.addEventListener("scroll",h),o.addEventListener("wheel",p,{passive:!0}),o.addEventListener("touchstart",b,{passive:!0}),o.addEventListener("touchend",g,{passive:!0}),{p:()=>{o.removeEventListener("scroll",h),o.removeEventListener("wheel",p),o.removeEventListener("touchstart",b),o.removeEventListener("touchend",g),d.h()},m:()=>{const[e,o]=t.$();e&&(n(J(e,r),o,$),$=!1,o&&t.$getViewportSize()>t.$getTotalSize()&&t.$update(1,s()))}}},B=(e,t,o)=>{let r;return[async(s,n)=>{if(!await t())return;r&&r();const c=()=>{const[t,o]=l();return r=()=>{o(!1)},e.$getViewportSize()&&R(r,150),[t,e.$subscribe(2,(()=>{o(!0)}))]};if(n&&k())e.$update(8,s()),i((async()=>{for(;;){let t=!0;for(let[o,r]=e.$getRange();o<=r;o++)if(e.$isUnmeasuredItem(o)){t=!1;break}if(t)break;const[o,r]=c();try{if(!await o)return}finally{r()}}e.$update(7),o(s(),n)}));else for(;;){const[t,r]=c();try{if(e.$update(7),o(s()),!await t)return}finally{r()}}},()=>{r&&r()}]},C=(e,t)=>{let o,r,s=l();const c=t?"scrollLeft":"scrollTop",i=t?"overflowX":"overflowY",[f,a]=B(e,(()=>s[0]),((e,r)=>{e=J(e,t),r?o.scrollTo({[t?"left":"top"]:e,behavior:"smooth"}):o[c]=e}));return{$observe(n){o=n,r=W(e,n,t,(()=>J(n[c],t)),((t,o,r)=>{if(r){const e=n.style,t=e[i];e[i]="hidden",R((()=>{e[i]=t}))}n[c]=e.$getScrollOffset()+t,o&&a()})),s[1](!0)},$dispose(){r&&r.p(),s[1](!1),s=l()},$scrollTo(e){f((()=>e))},$scrollBy(t){t+=e.$getScrollOffset(),f((()=>t))},$scrollToIndex(t,{align:o,smooth:r,offset:s=0}={}){if(t=n(t,0,e.$getItemsLength()-1),"nearest"===o){const r=e.$getItemOffset(t),s=e.$getScrollOffset();if(r<s)o="start";else{if(!(r+e.$getItemSize(t)>s+e.$getViewportSize()))return;o="end"}}f((()=>s+e.$getStartSpacerSize()+e.$getItemOffset(t)+("end"===o?e.$getItemSize(t)-e.$getViewportSize():"center"===o?(e.$getItemSize(t)-e.$getViewportSize())/2:0)),r)},$fixScrollJump:()=>{r&&r.m()}}},L=(e,t)=>{let o,r,s=l();const c=t?"left":"top",[i]=B(e,(()=>s[0]),((e,r)=>{e=J(e,t);const s=v(m(o));r?s.scroll({[c]:e,behavior:"smooth"}):s.scroll({[c]:e})})),f=(e,t,o,r,s=0)=>{const n=r?"offsetLeft":"offsetTop",c=s+(r&&w()?o.innerWidth-e[n]-e.offsetWidth:e[n]),i=e.offsetParent;return e!==t&&i?f(i,t,o,r,c):c};return{$observe(n){o=n;const i=t?"scrollX":"scrollY",l=m(n),a=v(l);r=W(e,a,t,(()=>J(a[i],t)),((t,o)=>{o?a.scroll({[c]:e.$getScrollOffset()+t}):a.scrollBy({[c]:t})}),(()=>f(n,l.body,a,t))),s[1](!0)},$dispose(){r&&r.p(),o=void 0,s[1](!1),s=l()},$fixScrollJump:()=>{r&&r.m()},$scrollToIndex(r,{align:s,smooth:c,offset:l=0}={}){if(!o)return;if(r=n(r,0,e.$getItemsLength()-1),"nearest"===s){const t=e.$getItemOffset(r),o=e.$getScrollOffset();if(t<o)s="start";else{if(!(t+e.$getItemSize(r)>o+e.$getViewportSize()))return;s="end"}}const a=m(o),u=v(a),$=a.documentElement,d=()=>e.$getViewportSize()-(t?$.clientWidth:$.clientHeight);i((()=>l+f(o,a.body,u,t)+e.$getItemOffset(r)+("end"===s?e.$getItemSize(r)-(e.$getViewportSize()-d()):"center"===s?(e.$getItemSize(r)-(e.$getViewportSize()-d()))/2:0)),c)}}},O=(e,t)=>{const o=C(e,!1),r=C(t,!0);return{$observe(e){o.$observe(e),r.$observe(e)},$dispose(){o.$dispose(),r.$dispose()},$scrollTo(e,t){o.$scrollTo(t),r.$scrollTo(e)},$scrollBy(e,t){o.$scrollBy(t),r.$scrollBy(e)},$scrollToIndex(e,t){o.$scrollToIndex(t),r.$scrollToIndex(e)},$fixScrollJump(){o.$fixScrollJump(),r.$fixScrollJump()}}},P=e=>{let t;return{v(o){(t||(t=new(v(m(o)).ResizeObserver)(e))).observe(o)},S(e){t.unobserve(e)},p(){t&&t.disconnect()}}},q=(t,o)=>{let r;const s=o?"width":"height",n=new WeakMap,c=P((o=>{const c=[];for(const{target:i,contentRect:l}of o)if(i.offsetParent)if(i===r)t.$update(4,l[s]);else{const t=n.get(i);t!=e&&c.push([t,l[s]])}c.length&&t.$update(3,c)}));return{$observeRoot(e){c.v(r=e)},$observeItem:(e,t)=>(n.set(e,t),c.v(e),()=>{n.delete(e),c.S(e)}),$dispose:c.p}},V=(t,o)=>{const r=o?"width":"height",s=o?"innerWidth":"innerHeight",n=new WeakMap,c=P((o=>{const s=[];for(const{target:t,contentRect:c}of o){if(!t.offsetParent)continue;const o=n.get(t);o!=e&&s.push([o,c[r]])}s.length&&t.$update(3,s)}));let l;return{$observeRoot(e){const o=v(m(e)),r=()=>{t.$update(4,o[s])};o.addEventListener("resize",r),i(r),l=()=>{o.removeEventListener("resize",r)}},$observeItem:(e,t)=>(n.set(e,t),c.v(e),()=>{n.delete(e),c.S(e)}),$dispose(){l&&l(),c.p()}}},X=(e,t)=>{let r;const s=new WeakMap,n=new Set,c=new Set,i=new Map,l=(e,t)=>`${e}-${t}`,f=P((f=>{const a=new Set,u=new Set;for(const{target:o,contentRect:{width:n,height:c}}of f)if(o.offsetParent)if(o===r)e.$update(4,c),t.$update(4,n);else{const e=s.get(o);if(e){const[t,o]=e,r=l(t,o),s=i.get(r);let f,$;s?(s[0]!==c&&(f=!0),s[1]!==n&&($=!0)):f=$=!0,f&&a.add(t),$&&u.add(o),(f||$)&&i.set(r,[c,n])}}if(a.size){const t=[];a.forEach((e=>{let r=0;c.forEach((t=>{const s=i.get(l(e,t));s&&(r=o(r,s[0]))})),r&&t.push([e,r])})),e.$update(3,t)}if(u.size){const e=[];u.forEach((t=>{let r=0;n.forEach((e=>{const s=i.get(l(e,t));s&&(r=o(r,s[1]))})),r&&e.push([t,r])})),t.$update(3,e)}}));return{$observeRoot(e){f.v(r=e)},$observeItem:(e,t,o)=>(s.set(e,[t,o]),n.add(t),c.add(o),f.v(e),()=>{s.delete(e),f.S(e)}),$resizeCols(o){for(const[t]of o)for(let o=0;o<e.$getItemsLength();o++)i.delete(l(o,t));t.$update(3,o)},$resizeRows(o){for(const[e]of o)for(let o=0;o<t.$getItemsLength();o++)i.delete(l(e,o));e.$update(3,o)},$dispose:f.p}};export{I as ACTION_ITEMS_LENGTH_CHANGE,x as ACTION_START_OFFSET_CHANGE,z as UPDATE_SCROLL_END_EVENT,_ as UPDATE_SCROLL_EVENT,y as UPDATE_VIRTUAL_STATE,X as createGridResizer,O as createGridScroller,q as createResizer,C as createScroller,M as createVirtualStore,V as createWindowResizer,L as createWindowScroller,T as getScrollSize,b as isBrowser,w as isRTLDocument,i as microtask,c as sort};
//# sourceMappingURL=index.js.map
